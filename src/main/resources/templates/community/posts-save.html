<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>게시글 등록</title>
</head>
<body>

    <!-- 헤더 -->
    <th:block th:replace="fragment/header :: headerFragment"></th:block>

    <div>
        <form>
            <div>
                <label for="title">
                    제목
                </label>
                <input type="text" id="title" name="title">
            </div>

            <div>
                <label for="author">
                    작성자
                </label>
                <input type="text" id="author" name="author">
            </div>

            <div>
                <label for="content">
                    내용
                </label>
                <textarea name="content" id="content" cols="30" rows="10" placeholder="내용을 입력하세요"></textarea>
            </div>

            <button type="button" id="btn-save">등록</button>
            <a href="/">취소</a>

        </form>
    </div>

    <!-- 푸터 -->
    <th:block th:replace="fragment/footer :: footerFragment"></th:block>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
            integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
            crossorigin="anonymous"></script>

    <script>
        var main = {
            init : function() {
                var _this = this;
                $('#btn-save').on('click', function() {
                    _this.save();
                });
            },
            save : function() {
                var data = {
                    title: $('#title').val(),
                    author: $('#author').val(),
                    content: $('#content').val()
                };

                $.ajax({
                    type: 'POST',
                    url: '/api/v1/posts',
                    dataType: 'json',
                    contentType: 'application/json; charset=utf-8',
                    data: JSON.stringify(data)
                }).done(function() {
                    alert('글이 등록되었습니다.');
                    window.location.href = '/';
                }).fail(function(error) {
                    alert(JSON.stringify(error));
                });
            }
        };

        main.init();
    </script>

</body>
</html>